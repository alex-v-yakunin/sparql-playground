# CONSTRUCT: Граф технологических зависимостей
#
# Создание графа для визуализации зависимостей технологий
# Включает категории технологий и уровень зависимости
#
# Результат можно экспортировать в:
# - Gephi (визуализация графов)
# - Neo4j (графовая БД)
# - D3.js (веб-визуализация)
#
# В SQL: невозможно создать граф - только таблицы
# В SPARQL: CONSTRUCT генерирует полноценный RDF граф
#
# Ожидаемый результат: RDF граф с метаданными для визуализации
# - Связи зависимостей до 3 уровней глубины
# - Категории технологий
# - Метки для отображения
# Время: < 1 секунды

PREFIX : <http://example.org/adr#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

CONSTRUCT {
    ?tech1 :dependsOn ?tech2 .
    ?tech1 :category ?category1 .
    ?tech2 :category ?category2 .
    ?tech1 rdfs:label ?label1 .
    ?tech2 rdfs:label ?label2 .
    ?tech1 :depthLevel ?level .
}
WHERE {
    # Технология должна быть в ADR
    ?adr :decidesTechnology ?tech1 .
    ?tech1 rdfs:label ?label1 .
    
    # Её зависимости (до 3 уровней через UNION)
    {
        ?tech1 :dependsOn ?tech2 .
        ?tech2 rdfs:label ?label2 .
        BIND(1 AS ?level)
    } UNION {
        ?tech1 :dependsOn/:dependsOn ?tech2 .
        ?tech2 rdfs:label ?label2 .
        BIND(2 AS ?level)
    } UNION {
        ?tech1 :dependsOn/:dependsOn/:dependsOn ?tech2 .
        ?tech2 rdfs:label ?label2 .
        BIND(3 AS ?level)
    }
    
    # Категории технологий
    OPTIONAL { ?tech1 a ?category1 . FILTER(?category1 != :Technology) }
    OPTIONAL { ?tech2 a ?category2 . FILTER(?category2 != :Technology) }
}

# Новый граф содержит:
# - Связи между технологиями
# - Категории (MessageBroker, Database, etc.)
# - Метки для отображения
# - Уровень глубины для layout
#
# Импортируйте в Gephi для создания красивой визуализации!

