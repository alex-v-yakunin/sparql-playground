# Data Source Reliability Analysis
#
# Calculate average confidence level for each data source.
#
# Expected result: 3 sources (adr-registry: ~0.94, confluence: ~0.76, interview-notes: ~0.54)
# Execution time: < 1 second

PREFIX : <http://example.org/adr#>

SELECT ?source 
       (AVG(?confidence) AS ?avgConfidence)    # Average confidence by source
       (COUNT(?adr) AS ?adrCount)              # Number of ADRs in source
WHERE {
    GRAPH ?source {                    # For each named graph
        ?adr a :ADR ;                  # Find all ADRs
             :hasConfidence ?confidence .  # Get confidence level
    }
}
GROUP BY ?source                       # Group by source
ORDER BY DESC(?avgConfidence)          # Sort from best to worst

# Explanation:
# Helps evaluate which sources provide higher quality data.
# Aggregation by named graphs - unique SPARQL capability.
# AVG calculates average confidence for each source.
# In SQL: SELECT source, AVG(confidence), COUNT(*) FROM ... GROUP BY source
# In Property Graph: aggregation by node labels/properties.
