# ADR из нескольких источников
#
# Найти ADR, задокументированные более чем в одном месте.
# Может указывать на хорошо задокументированные решения ИЛИ на противоречивую информацию.
#
# В SQL: сложный GROUP BY с подзапросами
# В SPARQL: COUNT(DISTINCT ?source) с HAVING - естественный способ
#
# Ожидаемый результат: 2 ADR (ADR-007, ADR-008)
# Время: < 1 секунды

PREFIX : <http://example.org/adr#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?adr ?label (COUNT(DISTINCT ?source) AS ?sourceCount)
WHERE {
    GRAPH ?source {
        ?adr a :ADR ;
             rdfs:label ?label .
    }
}
GROUP BY ?adr ?label
HAVING (?sourceCount > 1)
ORDER BY DESC(?sourceCount)

