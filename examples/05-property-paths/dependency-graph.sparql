# Полный граф зависимостей до 3 уровней
#
# Строит полную карту зависимостей для визуализации.
# Используем UNION для явного указания глубины 1, 2 и 3 уровня.
#
# В SQL: невозможно выразить элегантно!
# В SPARQL: property paths с явным указанием уровней через UNION
#
# Ожидаемый результат: 256 пар технология→зависимость до 3 уровней глубины
# Время: < 1 секунды

PREFIX : <http://example.org/adr#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?techLabel ?depLabel ?depthLevel
WHERE {
    # Технология должна быть использована в ADR
    ?adr :decidesTechnology ?tech .
    ?tech rdfs:label ?techLabel .
    
    # Найти зависимости на глубину от 1 до 3 уровней (используем альтернативные пути)
    {
        ?tech :dependsOn ?dep .
        ?dep rdfs:label ?depLabel .
        BIND(1 AS ?depthLevel)
    } UNION {
        ?tech :dependsOn/:dependsOn ?dep .
        ?dep rdfs:label ?depLabel .
        BIND(2 AS ?depthLevel)
    } UNION {
        ?tech :dependsOn/:dependsOn/:dependsOn ?dep .
        ?dep rdfs:label ?depLabel .
        BIND(3 AS ?depthLevel)
    }
}
ORDER BY ?techLabel ?depthLevel ?depLabel

# Этот запрос создаёт данные для визуализации:
# Kafka → Java (уровень 1)
# Kafka → Zookeeper (уровень 1)
# Kafka → JVM (уровень 2, через Java)
# ...
#
# Можно импортировать в Gephi, Cytoscape или D3.js для визуализации

