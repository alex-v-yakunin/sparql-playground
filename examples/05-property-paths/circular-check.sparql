# Проверка на циклические зависимости
#
# Обнаружить циклы в графе зависимостей технологий.
#
# Ожидаемый результат: 1 цикл (Docker → ServiceMesh → Kubernetes → Docker)
# Время выполнения: < 1 секунды

PREFIX : <http://example.org/adr#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?technology ?label
WHERE {
    ?tech :dependsOn+ ?tech ;          # Транзитивная зависимость сама на себя
          rdfs:label ?label .          # Получить название технологии
    
    BIND(STR(?tech) AS ?technology)    # Преобразовать URI в строку
}

# Пояснение:
# Property Path :dependsOn+ означает "один или более шагов по :dependsOn".
# Паттерн ?tech :dependsOn+ ?tech ищет технологии, зависящие от самих себя через цепочку.
# Это антипаттерн в архитектуре, требующий немедленного внимания!
# В SQL потребовались бы рекурсивные CTE (Common Table Expressions).
# В Property Graph: аналогичный обход с проверкой на цикл.
# В отличие от SQL, SPARQL естественно работает с транзитивными связями.
