# Цепочка доказательств для архитектурных решений
#
# Reification хранит не только КТО и КОГДА,
# но и источники доказательств (evidence sources)
#
# Это критично для:
# - Audit compliance
# - Воспроизводимости решений
# - Обоснования перед stakeholders
#
# В SQL: таблица evidence_links, но без контекста
# В RDF: метаданные связаны напрямую с утверждением
#
# Ожидаемый результат: Решения с их доказательной базой
# - ADR-001 | Kafka | Иван Петров | LoadTestResults | (URL)
# - ADR-002 | PostgreSQL | Мария Сидорова | DatabaseBenchmark
# - ADR-005 | PostgreSQL | Мария Сидорова | ProductionIncidentAnalysis
# Время: < 1 секунда

PREFIX : <http://example.org/adr#>
PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

SELECT ?adrLabel ?techLabel ?personName ?evidenceType ?evidenceURL
WHERE {
    ?stmt a rdf:Statement ;
          rdf:subject ?adr ;
          rdf:predicate :decidesTechnology ;
          rdf:object ?tech ;
          :statedBy ?person ;
          :evidenceSource ?evidenceType .
    
    ?adr rdfs:label ?adrLabel .
    ?tech rdfs:label ?techLabel .
    ?person rdfs:label ?personName .
    
    # URL на доказательства (если есть)
    OPTIONAL { ?stmt :evidenceURL ?evidenceURL }
}
ORDER BY ?adrLabel

# ========================================
# ДОПОЛНИТЕЛЬНЫЙ ЗАПРОС: Red Flags для Governance
# ========================================
# 
# Найти решения БЕЗ доказательств (evidenceSource)
# Раскомментируйте для проверки качества данных:
#
# SELECT ?adrLabel ?techLabel ?personName
# WHERE {
#     ?stmt a rdf:Statement ;
#           rdf:subject ?adr ;
#           rdf:predicate :decidesTechnology ;
#           rdf:object ?tech ;
#           :statedBy ?person .
#     
#     ?adr rdfs:label ?adrLabel .
#     ?tech rdfs:label ?techLabel .
#     ?person rdfs:label ?personName .
#     
#     # ⚠️ Решение БЕЗ доказательств
#     FILTER NOT EXISTS { ?stmt :evidenceSource ?evidence }
# }
#
# Ожидаемый результат:
# - ADR-006 | Redis | Дмитрий Волков (⚠️ решение без доказательств)
#
# Это критично для governance:
# - Решения должны быть обоснованы
# - Без evidence = архитектурный долг
# - Требует ревью и дополнения
