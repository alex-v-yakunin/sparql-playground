@prefix : <http://example.org/adr#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .

# ============================================
# REIFICATION: METADATA ABOUT DECISIONS
# ============================================
#
# This file demonstrates reification -
# ability to store metadata about triples:
# WHO said, WHEN, with what CONFIDENCE
#
# In SQL separate metadata tables are needed!
# ============================================

# ----- People (architects) -----

GRAPH :people {
    :person_IvanPetrov a :Person ;
        rdfs:label "Ivan Petrov" ;
        :fullName "Ivan Petrov" ;
        :role :LeadArchitect ;
        :team :TeamPlatform ;
        :email "ivan.petrov@company.com" ;
        :nationality "Russia" ;
        :expertise ( :Microservices :EventDriven :Kafka :Kubernetes ) ;
        :yearsOfExperience 12 .

    :person_JohnSmith a :Person ;
        rdfs:label "John Smith" ;
        :fullName "John Michael Smith" ;
        :role :DataArchitect ;
        :team :TeamData ;
        :email "john.smith@company.com" ;
        :nationality "USA" ;
        :expertise ( :Databases :DataModeling :PostgreSQL :Analytics ) ;
        :yearsOfExperience 10 .

    :person_HansMueller a :Person ;
        rdfs:label "Hans Müller" ;
        :fullName "Hans Friedrich Müller" ;
        :role :CTO ;
        :team :Leadership ;
        :email "hans.mueller@company.com" ;
        :nationality "Germany" ;
        :expertise ( :Strategy :Architecture :CloudNative ) ;
        :yearsOfExperience 15 .

    :person_ElenaIonescu a :Person ;
        rdfs:label "Elena Ionescu" ;
        :fullName "Elena Maria Ionescu" ;
        :role :SecurityArchitect ;
        :team :Security ;
        :email "elena.ionescu@company.com" ;
        :nationality "Romania" ;
        :expertise ( :Security :Compliance :GDPR ) ;
        :yearsOfExperience 8 .

    :person_MarkoKovacic a :Person ;
        rdfs:label "Marko Kovačić" ;
        :fullName "Marko Kovačić" ;
        :role :DevOpsLead ;
        :team :TeamPlatform ;
        :email "marko.kovacic@company.com" ;
        :nationality "Croatia" ;
        :expertise ( :Kubernetes :Docker :Monitoring ) ;
        :yearsOfExperience 9 .
}

# ----- Reified statements for ADR-001 -----

GRAPH :decision-metadata {
    # Main decision: ADR-001 uses Kafka
    :stmt_adr001_kafka a rdf:Statement ;
        rdf:subject :ADR-001 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :Kafka ;
        # Decision metadata
        :statedBy :person_IvanPetrov ;
        :statedOn "2024-12-15T14:30:00"^^xsd:dateTime ;
        :confidence 0.95 ;
        :evidenceSource :LoadTestResults ;
        :evidenceURL "https://confluence.company.com/load-tests/kafka-2024-12" ;
        # Decision making process
        :discussionThread "https://confluence.company.com/ADR-001-discussion" ;
        :reviewDuration "P14D"^^xsd:duration ;  # 14 days of discussion
        :approvedBy ( :person_IvanPetrov :person_JohnSmith :person_HansMueller ) ;
        # Voting results
        :votingResult [
            :inFavor 8 ;
            :against 1 ;
            :abstain 2 ;
            :totalVoters 11
        ] ;
        # Additional context
        :decisionRationale "Event streaming needed for Order Service" ;
        :expectedImpact "Latency reduction from 500ms to 50ms" .

    # Decision: ADR-001 applies to OrderService
    :stmt_adr001_orderservice a rdf:Statement ;
        rdf:subject :ADR-001 ;
        rdf:predicate :appliesTo ;
        rdf:object :OrderService ;
        :statedBy :person_IvanPetrov ;
        :statedOn "2024-12-15T14:30:00"^^xsd:dateTime ;
        :confidence 1.0 ;
        :evidenceSource :SystemArchitectureDocument .
}

# ----- Reified statements for ADR-002 -----

GRAPH :decision-metadata {
    :stmt_adr002_postgresql a rdf:Statement ;
        rdf:subject :ADR-002 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :PostgreSQL ;
        :statedBy :person_JohnSmith ;
        :statedOn "2024-11-20T10:15:00"^^xsd:dateTime ;
        :confidence 0.92 ;
        :evidenceSource :DatabaseBenchmark ;
        :discussionThread "https://confluence.company.com/ADR-002-discussion" ;
        :approvedBy ( :person_JohnSmith :person_ElenaIonescu :person_HansMueller ) ;
        :votingResult [
            :inFavor 9 ;
            :against 0 ;
            :abstain 1 ;
            :totalVoters 10
        ] ;
        :decisionRationale "ACID compliance critical for payment transactions" ;
        :complianceRequirements ( "PCI DSS" "GDPR" "SOC2" ) .
}

# ----- Reified statements for ADR-004 (rejected) -----

GRAPH :decision-metadata {
    :stmt_adr004_mongodb a rdf:Statement ;
        rdf:subject :ADR-004 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :MongoDB ;
        # Initial proposal
        :statedBy :person_IvanPetrov ;
        :statedOn "2024-01-10T10:00:00"^^xsd:dateTime ;
        :confidence 0.45 ;
        :evidenceSource :InterviewNotes ;
        :decisionRationale "Schema flexibility for payment history" ;
        # Decision rejection
        :rejectedOn "2024-06-20T15:00:00"^^xsd:dateTime ;
        :rejectedBy :person_JohnSmith ;
        :rejectionReason "Performance issues in production, lack of ACID" ;
        :supersededBy :stmt_adr005_postgresql ;
        # Failure details
        :productionIssues [
            :issueType "Performance" ;
            :description "Slow aggregation queries" ;
            :discoveredOn "2024-05-15"^^xsd:date
        ] ;
        :productionIssues [
            :issueType "DataConsistency" ;
            :description "Transaction loss during failures" ;
            :discoveredOn "2024-06-01"^^xsd:date
        ] .
}

# ----- Reified statements for ADR-005 (replaces ADR-004) -----

GRAPH :decision-metadata {
    :stmt_adr005_postgresql a rdf:Statement ;
        rdf:subject :ADR-005 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :PostgreSQL ;
        :statedBy :person_JohnSmith ;
        :statedOn "2024-06-25T11:00:00"^^xsd:dateTime ;
        :confidence 0.90 ;
        :evidenceSource :ProductionIncidentAnalysis ;
        :supersedes :stmt_adr004_mongodb ;
        :approvedBy ( :person_JohnSmith :person_HansMueller ) ;
        :votingResult [
            :inFavor 10 ;
            :against 0 ;
            :abstain 0 ;
            :totalVoters 10
        ] ;
        :decisionRationale "ACID guarantees critical for payment history, unification with ADR-002" ;
        :migrationCompleted "2024-07-15"^^xsd:date ;
        :migrationDuration "P20D"^^xsd:duration .
}

# ----- Reified statements for ADR-007 (multiple sources) -----

# Main decision from registry
GRAPH :decision-metadata {
    :stmt_adr007_kubernetes a rdf:Statement ;
        rdf:subject :ADR-007 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :Kubernetes ;
        :statedBy :person_MarkoKovacic ;
        :statedOn "2024-10-01T09:00:00"^^xsd:dateTime ;
        :confidence 0.98 ;
        :evidenceSource :PlatformStrategy ;
        :approvedBy ( :person_MarkoKovacic :person_IvanPetrov :person_HansMueller ) ;
        :votingResult [
            :inFavor 11 ;
            :against 0 ;
            :abstain 0 ;
            :totalVoters 11
        ] ;
        :decisionRationale "Industry standard for container orchestration" .
}

# Additional information from confluence
GRAPH :confluence-metadata {
    :stmt_adr007_docker a rdf:Statement ;
        rdf:subject :ADR-007 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :Docker ;
        :statedBy :person_MarkoKovacic ;
        :statedOn "2024-10-01T09:30:00"^^xsd:dateTime ;
        :confidence 0.75 ;
        :evidenceSource :TechnicalDocumentation ;
        :decisionRationale "Docker as base runtime for Kubernetes" .
}

# ----- Decision timeline -----

GRAPH :decision-timeline {
    :timeline_2024_q1 a :DecisionPeriod ;
        rdfs:label "Q1 2024" ;
        :period "2024-01/2024-03" ;
        :decisionsProposed ( :ADR-004 ) ;
        :decisionsAccepted ( ) .

    :timeline_2024_q2 a :DecisionPeriod ;
        rdfs:label "Q2 2024" ;
        :period "2024-04/2024-06" ;
        :decisionsProposed ( ) ;
        :decisionsRejected ( :ADR-004 ) ;
        :decisionsAccepted ( :ADR-005 ) .

    :timeline_2024_q3 a :DecisionPeriod ;
        rdfs:label "Q3 2024" ;
        :period "2024-07/2024-09" ;
        :decisionsProposed ( ) ;
        :decisionsAccepted ( ) .

    :timeline_2024_q4 a :DecisionPeriod ;
        rdfs:label "Q4 2024" ;
        :period "2024-10/2024-12" ;
        :decisionsProposed ( :ADR-006 ) ;
        :decisionsAccepted ( :ADR-001 :ADR-007 ) .
}

# ----- Reified statement WITHOUT evidenceSource (RED FLAG!) -----

GRAPH :decision-metadata {
    # ⚠️ ADR-006: Redis - decision WITHOUT evidence!
    # This is architectural "red flag" for governance
    :stmt_adr006_redis a rdf:Statement ;
        rdf:subject :ADR-006 ;
        rdf:predicate :decidesTechnology ;
        rdf:object :Redis ;
        # Metadata exists
        :statedBy :person_MarkoKovacic ;
        :statedOn "2024-12-10T16:00:00"^^xsd:dateTime ;
        :confidence 0.65 .
        # ⚠️ BUT: :evidenceSource is missing!
        # ⚠️ And :evidenceURL too!
        # This decision made "by gut feel" without evidence
}

